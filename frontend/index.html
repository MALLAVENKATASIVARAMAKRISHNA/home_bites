<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Home Bites - Order Tasty & Fresh Food</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="./styles.css" />
<style>
  :root {
    --cream: #fdf8f3;
    --warm-white: #fffcf8;
    --orange: #ff4500;
    --orange-light: #ff6b35;
    --green: #2ecc71;
    --green-dark: #27ae60;
    --text-dark: #1a1a1a;
    --text-mid: #4a4a4a;
    --text-light: #8a8a8a;
    --border: #ede8e0;
    --shadow: rgba(255, 69, 0, 0.12);
    --danger: #b42318;
    --success: #157347;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--cream);
    color: var(--text-dark);
    overflow-x: hidden;
  }

  nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 60px;
    background: rgba(253, 248, 243, 0.92);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
  }

  .logo {
    font-family: 'Playfair Display', serif;
    font-size: 28px;
    font-weight: 900;
    color: var(--orange);
    letter-spacing: -1px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .logo img {
    width: 30px;
    height: 30px;
    border-radius: 8px;
    object-fit: cover;
    background: #fff;
  }

  .logo span { color: var(--text-dark); }

  .nav-links {
    display: flex;
    gap: 36px;
    list-style: none;
  }

  .nav-links a {
    text-decoration: none;
    color: var(--text-mid);
    font-weight: 500;
    font-size: 15px;
    transition: color 0.2s;
  }

  .nav-links a:hover { color: var(--orange); }

  .nav-actions {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .profile-wrapper {
    position: relative;
  }

  .profile-btn {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    border: 2px solid transparent;
    background: var(--orange);
    color: #fff;
    font-weight: 700;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: border 0.2s ease, transform 0.2s ease;
  }

  .profile-btn:hover {
    border-color: rgba(255, 255, 255, 0.6);
    transform: translateY(-1px);
  }

  .profile-dropdown {
    position: absolute;
    top: calc(100% + 10px);
    right: 0;
    width: 220px;
    padding: 12px 14px;
    background: #fff;
    border-radius: 14px;
    border: 1px solid var(--border);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    display: none;
    z-index: 110;
  }

  .profile-dropdown.active {
    display: block;
  }

  .profile-details strong {
    display: block;
    font-size: 14px;
    color: var(--text-dark);
    margin-bottom: 4px;
  }

  .profile-details span {
    display: block;
    font-size: 13px;
    color: var(--text-mid);
    line-height: 1.4;
  }

  .profile-logout-btn {
    width: 100%;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid #a11a14;
    font-size: 13px;
    font-weight: 700;
    margin-top: 8px;
    background: #b42318;
    color: #fff;
    cursor: pointer;
    transition: background 0.2s ease, transform 0.2s ease;
  }

  .profile-logout-btn:hover {
    background: #951910;
    transform: translateY(-1px);
  }

  .btn-signin {
    background: none;
    border: none;
    font-family: inherit;
    font-size: 15px;
    font-weight: 500;
    color: var(--text-mid);
    cursor: pointer;
    transition: color 0.2s;
  }

  .btn-signin:hover { color: var(--orange); }

  .btn-signup {
    background: var(--green);
    color: #fff;
    border: none;
    padding: 10px 22px;
    border-radius: 100px;
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s, transform 0.2s;
  }

  .btn-signup:hover { background: var(--green-dark); transform: translateY(-1px); }

  .cart-icon {
    position: relative;
    cursor: pointer;
    font-size: 22px;
  }

  .cart-badge {
    position: absolute;
    top: -6px;
    right: -6px;
    background: var(--orange);
    color: #fff;
    font-size: 10px;
    font-weight: 700;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hero {
    min-height: 100vh;
    display: grid;
    grid-template-columns: 1fr 1fr;
    align-items: center;
    padding: 120px 60px 80px;
    position: relative;
    overflow: hidden;
    background: linear-gradient(135deg, #fff4eb, #ffe2d2 45%, #ffe5d6 80%);
    border-radius: 40px;
    margin: 0 60px 40px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
  }

  .hero::before {
    content: '';
    position: absolute;
    top: -100px;
    right: -100px;
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, rgba(255,69,0,0.08) 0%, transparent 70%);
    border-radius: 50%;
  }

  .hero::after {
    content: '';
    position: absolute;
    bottom: -80px;
    left: 30%;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(46,204,113,0.07) 0%, transparent 70%);
    border-radius: 50%;
  }

  .hero-left {
    z-index: 2;
    animation: fadeUp 0.8s ease forwards;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(40px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .hero-tag {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(255,69,0,0.08);
    color: var(--orange);
    padding: 6px 14px;
    border-radius: 100px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-bottom: 28px;
  }

  .hero-title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(44px, 7vw, 72px);
    font-weight: 900;
    line-height: 1.05;
    color: var(--text-dark);
    margin-bottom: 8px;
    letter-spacing: -2px;
  }

  .hero-title .accent {
    color: var(--orange);
    font-style: italic;
  }

  .hero-sub {
    font-size: 16px;
    color: var(--text-light);
    line-height: 1.7;
    max-width: 380px;
    margin-bottom: 40px;
    font-weight: 400;
  }

  .hero-actions {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 52px;
  }

  .btn-primary {
    background: var(--orange);
    color: white;
    border: none;
    padding: 16px 32px;
    border-radius: 100px;
    font-family: inherit;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s;
    box-shadow: 0 8px 24px rgba(255,69,0,0.3);
  }

  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(255,69,0,0.4); }

  .btn-ghost {
    background: none;
    border: 2px solid var(--border);
    color: var(--text-mid);
    padding: 14px 28px;
    border-radius: 100px;
    font-family: inherit;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.25s;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .btn-ghost:hover { border-color: var(--text-dark); color: var(--text-dark); }

  .social-proof {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .avatars { display: flex; }

  .avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    border: 3px solid var(--cream);
    margin-left: -10px;
    background: linear-gradient(135deg, #f093fb, #f5576c);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    color: #fff;
    font-weight: 700;
  }

  .avatar:first-child { margin-left: 0; }
  .avatar.av2 { background: linear-gradient(135deg, #4facfe, #00f2fe); }
  .avatar.av3 { background: linear-gradient(135deg, #43e97b, #38f9d7); }
  .avatar.av4 { background: linear-gradient(135deg, #fa709a, #fee140); }
  .avatar.more { background: var(--text-dark); font-size: 11px; }

  .proof-text strong {
    display: block;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-dark);
  }

  .proof-text span {
    font-size: 13px;
    color: var(--text-light);
  }

  .stars { color: #ffc107; font-size: 12px; }

  .hero-right {
    z-index: 2;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    animation: fadeUp 0.8s 0.2s ease both;
  }

  .food-circle {
    width: 420px;
    height: 420px;
    background: linear-gradient(145deg, #fff5f0, #fff);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 30px 80px rgba(255,69,0,0.12), 0 0 0 1px rgba(255,69,0,0.06);
    position: relative;
    animation: float 4s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-16px); }
  }

  .food-circle img {
    width: 74%;
    height: 74%;
    object-fit: cover;
    border-radius: 50%;
    border: 6px solid #fff;
    box-shadow: 0 8px 26px rgba(0,0,0,0.16);
  }

  .float-card {
    position: absolute;
    background: #fff;
    border-radius: 16px;
    padding: 12px 16px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    font-weight: 500;
    animation: float 3s ease-in-out infinite;
  }

  .float-card.card-1 { top: 10%; left: -10%; animation-delay: 0s; }
  .float-card.card-2 { bottom: 15%; right: -5%; animation-delay: 1s; }
  .float-card.card-3 { top: 40%; right: -12%; animation-delay: 0.5s; }

  .card-icon { font-size: 28px; }
  .card-label { color: var(--text-light); font-size: 11px; margin-bottom: 2px; }
  .card-value { color: var(--text-dark); font-weight: 700; }

  .categories {
    padding: 40px 60px 80px;
    position: relative;
    z-index: 2;
  }

  .section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    margin-bottom: 32px;
  }

  .section-title {
    font-family: 'Playfair Display', serif;
    font-size: 32px;
    font-weight: 700;
    color: var(--text-dark);
  }

  .see-all {
    color: var(--orange);
    font-weight: 600;
    font-size: 14px;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: gap 0.2s;
  }

  .see-all:hover { gap: 8px; }

  .food-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 24px;
  }

  .fig-food-card {
    background: #fff;
    border-radius: 24px;
    padding: 24px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
    min-height: 360px;
    display: flex;
    flex-direction: column;
  }

  .fig-food-card::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 24px;
    border: 2px solid transparent;
    transition: border-color 0.3s;
    pointer-events: none;
  }

  .fig-food-card:hover { transform: translateY(-6px); box-shadow: 0 16px 40px rgba(255,69,0,0.12); }
  .fig-food-card:hover::before { border-color: rgba(255,69,0,0.2); }

  .food-card-img {
    width: 100%;
    height: 140px;
    border-radius: 16px;
    background: linear-gradient(135deg, #fff5f0, #ffe8d6);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 16px;
    overflow: hidden;
  }

  .food-card-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .food-emoji {
    font-size: 74px;
  }

  .food-card-name {
    font-family: 'Playfair Display', serif;
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 4px;
  }

  .food-card-desc {
    font-size: 13px;
    color: var(--text-light);
    margin-bottom: 14px;
    line-height: 1.5;
    flex: 1;
  }

  .food-card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
  }

  .food-price {
    font-size: 20px;
    font-weight: 700;
    color: var(--orange);
  }

  .btn-add {
    background: var(--orange);
    color: #fff;
    border: none;
    min-width: 36px;
    height: 36px;
    border-radius: 50%;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(255,69,0,0.3);
    padding: 0 11px;
  }

  .btn-add.wide {
    border-radius: 999px;
    width: auto;
    font-size: 14px;
    font-weight: 700;
  }

  .btn-add:hover { transform: scale(1.06); background: var(--orange-light); }

  .rating-row {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-bottom: 12px;
  }

  .rating-row .stars { font-size: 13px; }
  .rating-row span { font-size: 12px; color: var(--text-light); }

  .stats {
    background: var(--orange);
    margin: 0 60px;
    border-radius: 28px;
    padding: 40px 60px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    margin-bottom: 80px;
  }

  .stat-item { text-align: center; }

  .stat-num {
    font-family: 'Playfair Display', serif;
    font-size: 42px;
    font-weight: 900;
    color: #fff;
    line-height: 1;
    margin-bottom: 6px;
  }

  .stat-label { font-size: 14px; color: rgba(255,255,255,0.75); font-weight: 400; }

  .how { padding: 0 60px 100px; }
  .how .section-header { margin-bottom: 48px; }

  .steps {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 32px;
  }

  .step {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }

  .step-num {
    width: 56px;
    height: 56px;
    background: linear-gradient(135deg, var(--orange), var(--orange-light));
    color: #fff;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Playfair Display', serif;
    font-size: 22px;
    font-weight: 900;
    margin-bottom: 20px;
    box-shadow: 0 8px 20px rgba(255,69,0,0.25);
  }

  .step-title {
    font-family: 'Playfair Display', serif;
    font-size: 22px;
    font-weight: 700;
    margin-bottom: 10px;
  }

  .step-desc { font-size: 15px; color: var(--text-light); line-height: 1.7; }

  footer {
    background: var(--text-dark);
    color: #fff;
    padding: 42px 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 18px;
    flex-wrap: wrap;
  }

  .footer-logo {
    font-family: 'Playfair Display', serif;
    font-size: 32px;
    font-weight: 900;
    color: var(--orange);
  }

  .footer-copy { font-size: 14px; color: rgba(255,255,255,0.45); }

  .footer-links { display: flex; gap: 24px; }

  .footer-links a {
    color: rgba(255,255,255,0.65);
    text-decoration: none;
    font-size: 14px;
    transition: color 0.2s;
  }

  .footer-links a:hover { color: #fff; }

  .reveal {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }

  .reveal.visible {
    opacity: 1;
    transform: none;
  }

  .fig-cart-drawer {
    position: fixed;
    inset: 0;
    display: none;
    z-index: 220;
  }

  .fig-cart-drawer.active { display: block; }

  .fig-cart-overlay {
    position: absolute;
    inset: 0;
    background: rgba(26, 18, 11, 0.56);
  }

  .fig-cart-panel {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: min(420px, 92vw);
    background: #fff;
    padding: 18px;
    overflow-y: auto;
    box-shadow: -14px 0 34px rgba(0, 0, 0, 0.24);
  }

  .fig-cart-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
  }

  .fig-cart-head h3 {
    font-family: 'Playfair Display', serif;
    font-size: 26px;
  }

  .fig-close-btn {
    border: 1px solid var(--border);
    border-radius: 10px;
    background: #fff;
    padding: 6px 10px;
    font-weight: 600;
    cursor: pointer;
  }

  .fig-cart-empty {
    border: 1px dashed var(--border);
    border-radius: 12px;
    padding: 14px;
    color: var(--text-light);
  }

  .fig-cart-items {
    display: grid;
    gap: 10px;
    margin-top: 10px;
  }

  .fig-cart-line {
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
  }

  .fig-cart-line h4 {
    margin: 0;
    font-size: 15px;
  }

  .fig-cart-line p {
    margin: 3px 0 0;
    color: var(--text-light);
    font-size: 13px;
  }

  .fig-stepper {
    display: inline-flex;
    align-items: center;
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
  }

  .fig-stepper button {
    border: 0;
    background: #fff8f1;
    width: 28px;
    height: 28px;
    cursor: pointer;
    font-size: 16px;
  }

  .fig-stepper span {
    min-width: 28px;
    text-align: center;
    font-size: 13px;
    font-weight: 700;
  }

  .fig-cart-error {
    margin-top: 10px;
    border: 1px solid #f5c2c7;
    background: #f8d7da;
    color: #842029;
    border-radius: 10px;
    padding: 10px;
    font-size: 14px;
    display: none;
  }

  .fig-cart-success {
    margin-top: 10px;
    border: 1px solid #b7ebc6;
    background: #e9f9ef;
    color: #166534;
    border-radius: 10px;
    padding: 10px;
    display: none;
    font-size: 14px;
    font-weight: 600;
  }

  .fig-cart-summary {
    border-top: 1px solid var(--border);
    margin-top: 12px;
    padding-top: 12px;
  }

  .fig-summary-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 15px;
  }

  .fig-summary-row strong {
    font-size: 16px;
    color: var(--orange);
  }

  .fig-cart-summary label {
    display: block;
    margin-bottom: 5px;
    font-size: 13px;
    color: var(--text-light);
  }

  .fig-cart-summary select {
    width: 100%;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 10px;
    font-family: inherit;
    margin-bottom: 10px;
  }

  .fig-cart-summary button {
    width: 100%;
    border: 0;
    border-radius: 12px;
    padding: 12px;
    background: linear-gradient(90deg, var(--orange), var(--orange-light));
    color: #fff;
    font-family: inherit;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
  }

  .fig-cart-summary button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }

  .fig-cart-summary .note {
    margin-top: 8px;
    color: var(--text-light);
    font-size: 12px;
  }

  .auth-overlay {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1300;
    padding: 20px;
  }

  .auth-overlay.active { display: flex; }

  .auth-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(14, 23, 30, 0.78);
    backdrop-filter: blur(3px);
  }

  .auth-shell {
    width: min(1080px, 100%);
    max-height: calc(100vh - 40px);
    background: #fff8f0;
    border-radius: 22px;
    overflow: hidden;
    display: grid;
    grid-template-columns: 1.06fr 1fr;
    position: relative;
    z-index: 1;
    box-shadow: 0 30px 70px rgba(0, 0, 0, 0.34);
  }

  .auth-close {
    position: absolute;
    top: 12px;
    right: 12px;
    z-index: 5;
    border: 1px solid rgba(255, 255, 255, 0.45);
    background: rgba(0, 0, 0, 0.2);
    color: #fff;
    width: 34px;
    height: 34px;
    border-radius: 999px;
    cursor: pointer;
    font-size: 20px;
    line-height: 1;
  }

  .auth-left {
    background: linear-gradient(145deg, #1a120b 0%, #2d1b0e 50%, #3d2410 100%);
    padding: 30px;
    position: relative;
    color: #fff;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    gap: 24px;
  }

  .auth-left::before {
    content: '';
    position: absolute;
    width: 420px;
    height: 420px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 107, 53, 0.25) 0%, transparent 70%);
    top: -120px;
    left: -130px;
    pointer-events: none;
  }

  .auth-left::after {
    content: '';
    position: absolute;
    width: 320px;
    height: 320px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 184, 48, 0.16) 0%, transparent 70%);
    bottom: -110px;
    right: -80px;
    pointer-events: none;
  }

  .auth-brand {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    z-index: 1;
  }

  .auth-brand-icon {
    width: 42px;
    height: 42px;
    border-radius: 11px;
    display: grid;
    place-items: center;
    background: #ff6b35;
    font-size: 21px;
  }

  .auth-brand-name {
    font-family: 'Playfair Display', serif;
    font-size: 30px;
    font-weight: 900;
    line-height: 1;
    letter-spacing: -0.3px;
  }

  .auth-brand-name span { color: #ff6b35; }

  .auth-hero {
    z-index: 1;
    display: grid;
    place-items: center;
  }

  .auth-disc {
    width: min(340px, 78%);
    aspect-ratio: 1;
    border-radius: 50%;
    background:
      radial-gradient(circle at 50% 40%, rgba(255, 222, 180, 0.9), rgba(235, 132, 49, 0.95) 45%, rgba(148, 72, 15, 0.95) 72%),
      radial-gradient(circle at 32% 18%, rgba(255, 255, 255, 0.23), transparent 44%);
    position: relative;
    box-shadow: inset 0 -24px 56px rgba(81, 29, 8, 0.5), 0 24px 54px rgba(0, 0, 0, 0.38);
    animation: floatDish 4.2s ease-in-out infinite;
  }

  .auth-disc::after {
    content: '';
    position: absolute;
    left: 50%;
    bottom: -22px;
    transform: translateX(-50%);
    width: 72%;
    height: 22px;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.34);
    filter: blur(10px);
  }

  .auth-disc img {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 168px;
    height: 168px;
    border-radius: 28px;
    object-fit: cover;
    border: 4px solid rgba(255, 255, 255, 0.75);
    background: #fff;
  }

  .auth-tagline {
    z-index: 1;
  }

  .auth-tagline h2 {
    margin: 0;
    font-family: 'Playfair Display', serif;
    font-size: clamp(26px, 2.6vw, 38px);
    line-height: 1.22;
  }

  .auth-tagline em {
    font-style: normal;
    color: #ff6b35;
  }

  .auth-tagline p {
    margin: 10px 0 0;
    color: rgba(255, 255, 255, 0.66);
    font-size: 14px;
    line-height: 1.55;
  }

  .auth-right {
    padding: 30px;
    overflow-y: auto;
    background: #fff8f0;
    color: #1a120b;
    max-height: calc(100vh - 80px);
  }

  .auth-chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(255, 107, 53, 0.12);
    color: #ff6b35;
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 6px 14px;
    border-radius: 999px;
    margin-bottom: 14px;
  }

  .auth-title {
    margin: 0;
    font-family: 'Playfair Display', serif;
    font-size: clamp(30px, 2.7vw, 38px);
    line-height: 1.14;
  }

  .auth-subtitle {
    margin: 8px 0 16px;
    color: #7a6f68;
    font-size: 15px;
  }

  .auth-tabs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    padding: 4px;
    gap: 4px;
    border: 1px solid #e9ddd4;
    border-radius: 12px;
    background: #f6ebe2;
    margin-bottom: 16px;
  }

  .auth-tab {
    border: 0;
    border-radius: 9px;
    padding: 10px;
    background: transparent;
    font-family: inherit;
    font-weight: 700;
    color: #7a6f68;
    cursor: pointer;
  }

  .auth-tab.active {
    background: #fff;
    color: #1a120b;
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08);
  }

  .auth-view { display: none; }
  .auth-view.active { display: block; }
  .auth-group { margin-bottom: 12px; }

  .auth-label {
    display: block;
    font-size: 13px;
    font-weight: 700;
    margin-bottom: 7px;
  }

  .auth-input-wrap { position: relative; }

  .auth-input {
    width: 100%;
    padding: 13px 14px;
    border: 1.5px solid #e8ddd5;
    border-radius: 12px;
    background: #fff;
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  .auth-input.has-icon { padding-left: 38px; }

  .auth-input-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #92867e;
    font-size: 13px;
  }

  .auth-input:focus {
    border-color: #ff6b35;
    box-shadow: 0 0 0 4px rgba(255, 107, 53, 0.08);
  }

  .auth-eye {
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
    border: 0;
    background: none;
    color: #7a6f68;
    font-weight: 700;
    font-size: 12px;
    padding: 6px;
    cursor: pointer;
    border-radius: 7px;
  }

  .auth-eye:hover {
    color: #ff6b35;
    background: rgba(255, 107, 53, 0.08);
  }

  .auth-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin: 2px 0 14px;
  }

  .remember-wrap {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    user-select: none;
    color: #7a6f68;
    font-size: 14px;
  }

  .remember-wrap input { display: none; }

  .remember-mark {
    width: 18px;
    height: 18px;
    border-radius: 5px;
    border: 1.5px solid #d0c8c0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 12px;
    line-height: 1;
    transition: all 0.2s;
  }

  .auth-link {
    color: #ff6b35;
    text-decoration: none;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
  }

  .auth-link:hover { opacity: 0.75; }

  .auth-submit {
    width: 100%;
    border: 0;
    border-radius: 12px;
    background: linear-gradient(135deg, #ff6b35 0%, #e8521a 100%);
    color: #fff;
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    font-weight: 700;
    padding: 14px;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .auth-submit:hover {
    transform: translateY(-1px);
    box-shadow: 0 10px 24px rgba(255, 107, 53, 0.3);
  }

  .auth-submit:disabled {
    cursor: not-allowed;
    opacity: 0.7;
    transform: none;
    box-shadow: none;
  }

  .auth-switch {
    margin-top: 12px;
    text-align: center;
    color: #7a6f68;
    font-size: 14px;
  }

  .auth-alert {
    display: none;
    margin-top: 12px;
    padding: 11px 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
  }

  .auth-alert.show { display: block; }
  .auth-alert.success { background: #d4edda; color: #157347; border: 1px solid #c3e6cb; }
  .auth-alert.error { background: #f8d7da; color: #b42318; border: 1px solid #f5c6cb; }

  @keyframes floatDish {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-12px); }
  }

  @media (max-width: 1200px) {
    nav,
    .hero,
    .categories,
    .how,
    footer {
      padding-left: 28px;
      padding-right: 28px;
    }

    .stats {
      margin-left: 28px;
      margin-right: 28px;
      padding-left: 26px;
      padding-right: 26px;
    }

    .nav-links { display: none; }
  }

  @media (max-width: 980px) {
    .hero {
      grid-template-columns: 1fr;
      gap: 24px;
      padding-top: 108px;
    }

    .hero-right {
      order: -1;
    }

    .food-circle {
      width: 320px;
      height: 320px;
    }

    .float-card.card-1,
    .float-card.card-2,
    .float-card.card-3 {
      display: none;
    }

    .stats {
      grid-template-columns: 1fr 1fr;
    }

    .steps {
      grid-template-columns: 1fr;
    }

    .auth-shell {
      grid-template-columns: 1fr;
    }

    .auth-left {
      min-height: 250px;
    }
  }

  @media (max-width: 560px) {
    nav {
      padding: 14px 14px;
    }

    .logo {
      font-size: 24px;
    }

    .btn-signup {
      padding: 8px 14px;
    }

    .hero,
    .categories,
    .how,
    footer {
      padding-left: 14px;
      padding-right: 14px;
    }

    .stats {
      margin-left: 14px;
      margin-right: 14px;
      grid-template-columns: 1fr;
    }

    .hero-actions {
      flex-direction: column;
      align-items: flex-start;
    }

    .auth-row {
      flex-direction: column;
      align-items: flex-start;
    }
  }
</style>
</head>
<body>
<nav>
  <div class="logo"><img src="./assets/logo.png" alt="Home Bites" /><span>Home</span>Bites</div>
  <ul class="nav-links">
    <li><a href="#find-food">Find Food</a></li>
    <li><a href="#stats">Tracking</a></li>
    <li><a href="#find-food">Find Restaurant</a></li>
    <li><a href="#footer">Location</a></li>
  </ul>
  <div class="nav-actions">
    <div class="cart-icon" onclick="openCartDrawer()" aria-label="Open cart">üõí<span id="cartBadge" class="cart-badge">0</span></div>
    <button id="signInBtn" class="btn-signin" onclick="openAuthModal('login')">Sign In</button>
    <button id="signUpBtn" class="btn-signup" onclick="openAuthModal('signup')">Sign Up</button>
    <button id="myOrdersBtn" class="btn-signin" style="display:none;" onclick="showMyOrders()">My Orders</button>
    <div class="profile-wrapper" id="profileArea" style="display:none;">
      <button id="profileBtn" class="profile-btn" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Profile menu">
        <span id="profileInitial">üë§</span>
      </button>
      <div id="profileDropdown" class="profile-dropdown" role="menu" aria-label="Profile details">
        <div class="profile-details">
          <strong id="profileName">User</strong>
          <span id="profileEmail">Email</span>
          <span id="profilePhone">Phone</span>
        </div>
        <button class="profile-logout-btn" type="button" onclick="logout()">Logout</button>
      </div>
    </div>
  </div>
</nav>

<section class="hero">
  <div class="hero-left">
    <div class="hero-tag">üöÄ Easy way to order your food</div>
    <h1 class="hero-title">Order Tasty &<br />Fresh Food <span class="accent">anytime!</span></h1>
    <p class="hero-sub">Just confirm your order and enjoy our delicious fastest delivery. Fresh from the kitchen to your doorstep.</p>
    <div class="hero-actions">
      <button class="btn-primary" onclick="document.getElementById('find-food').scrollIntoView({behavior:'smooth'})">Order Now</button>
      <button class="btn-ghost" onclick="document.getElementById('find-food').scrollIntoView({behavior:'smooth'})">üìã See Menu</button>
    </div>
    <div class="social-proof">
      <div class="avatars">
        <div class="avatar av1">M</div>
        <div class="avatar av2">S</div>
        <div class="avatar av3">A</div>
        <div class="avatar av4">K</div>
        <div class="avatar more">2k+</div>
      </div>
      <div class="proof-text">
        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <strong>Our Happy Customers</strong>
        <span>28k+ reviews worldwide</span>
      </div>
    </div>
  </div>

  <div class="hero-right">
    <div class="food-circle">
      <img src="./assets/logo.png" alt="Home Bites" />
    </div>

    <div class="float-card card-1">
      <div class="card-icon">üö¥</div>
      <div>
        <div class="card-label">Delivery Time</div>
        <div class="card-value">~25 mins</div>
      </div>
    </div>

    <div class="float-card card-2">
      <div class="card-icon">‚≠ê</div>
      <div>
        <div class="card-label">Top Rated</div>
        <div class="card-value">4.9 / 5.0</div>
      </div>
    </div>

    <div class="float-card card-3">
      <div class="card-icon">üéâ</div>
      <div>
        <div class="card-label">Orders Today</div>
        <div class="card-value" id="ordersToday">0+</div>
      </div>
    </div>
  </div>
</section>

<section class="categories reveal" id="find-food">
  <div class="section-header">
    <h2 class="section-title">Special Picks For You</h2>
    <a href="#" class="see-all" onclick="event.preventDefault();">See All ‚Üí</a>
  </div>
  <div id="loadingItems" class="food-card-desc" style="margin-bottom: 14px;">Loading items...</div>
  <div id="foodCards" class="food-cards"></div>
</section>

<div class="stats reveal" id="stats">
  <div class="stat-item">
    <div class="stat-num">50k+</div>
    <div class="stat-label">Happy Customers</div>
  </div>
  <div class="stat-item">
    <div class="stat-num" id="menuCount">0+</div>
    <div class="stat-label">Menu Items</div>
  </div>
  <div class="stat-item">
    <div class="stat-num">4.9‚òÖ</div>
    <div class="stat-label">Average Rating</div>
  </div>
  <div class="stat-item">
    <div class="stat-num">25m</div>
    <div class="stat-label">Avg Delivery Time</div>
  </div>
</div>

<section class="how reveal">
  <div class="section-header">
    <h2 class="section-title">How It Works</h2>
    <a href="#" class="see-all" onclick="event.preventDefault();">Learn More ‚Üí</a>
  </div>
  <div class="steps">
    <div class="step">
      <div class="step-num">1</div>
      <div class="step-title">Choose Your Meal</div>
      <p class="step-desc">Browse our curated menu of fresh, chef-crafted dishes from top-rated home kitchens near you.</p>
    </div>
    <div class="step">
      <div class="step-num">2</div>
      <div class="step-title">Place Your Order</div>
      <p class="step-desc">Add items to your cart, confirm your delivery address, and pay securely in just a few taps.</p>
    </div>
    <div class="step">
      <div class="step-num">3</div>
      <div class="step-title">Enjoy Fast Delivery</div>
      <p class="step-desc">Track your delivery in real-time and enjoy your piping-hot meal at your doorstep.</p>
    </div>
  </div>
</section>

<div id="cartDrawer" class="fig-cart-drawer" aria-hidden="true">
  <div class="fig-cart-overlay" onclick="closeCartDrawer()"></div>
  <aside class="fig-cart-panel">
    <div class="fig-cart-head">
      <h3>Your Cart</h3>
      <button class="fig-close-btn" type="button" onclick="closeCartDrawer()">Close</button>
    </div>

    <div id="cartEmpty" class="fig-cart-empty">No items in cart yet.</div>
    <div id="cartItems" class="fig-cart-items"></div>
    <div id="cartError" class="fig-cart-error"></div>
    <div id="orderSuccess" class="fig-cart-success"></div>

    <div class="fig-cart-summary">
      <div class="fig-summary-row"><span>Subtotal</span><strong id="cartSubtotal">Rs 0</strong></div>

      <label for="paymentMode">Payment Mode</label>
      <select id="paymentMode">
        <option value="cash">Cash</option>
        <option value="upi">UPI</option>
        <option value="card">Card</option>
      </select>

      <button id="placeOrderBtn" type="button" onclick="placeOrder()">Place Order</button>
      <p class="note">Delivery address will use your profile details.</p>
    </div>
  </aside>
</div>

<div id="authOverlay" class="auth-overlay" aria-hidden="true">
  <div class="auth-backdrop" onclick="closeAuthModal()"></div>
  <div class="auth-shell" role="dialog" aria-modal="true" aria-label="Login and signup">
    <button type="button" class="auth-close" onclick="closeAuthModal()" aria-label="Close">&times;</button>

    <section class="auth-left" aria-hidden="true">
      <div class="auth-brand">
        <div class="auth-brand-icon">
          <img src="./assets/logo.png" alt="Home Bites logo" style="width:28px;height:28px;border-radius:6px;" />
        </div>
        <div class="auth-brand-name">Home <span>Bites</span></div>
      </div>

      <div class="auth-hero">
        <div class="auth-disc">
          <img src="./assets/logo.png" alt="" />
        </div>
      </div>

      <div class="auth-tagline">
        <h2>Delicious home food,<br />delivered <em>fast.</em></h2>
        <p>Login and continue ordering your favorite snacks, sweets, and daily specials.</p>
      </div>
    </section>

    <section class="auth-right">
      <div class="auth-chip">Welcome</div>
      <h2 class="auth-title">Sign in to your account</h2>
      <p class="auth-subtitle">New here? Create an account in seconds.</p>

      <div class="auth-tabs" role="tablist" aria-label="Auth forms">
        <button id="authLoginTab" class="auth-tab active" type="button" onclick="switchAuthView('login')">Login</button>
        <button id="authSignupTab" class="auth-tab" type="button" onclick="switchAuthView('signup')">Create Account</button>
      </div>

      <section id="authLoginView" class="auth-view active">
        <form id="loginForm" novalidate>
          <div class="auth-group">
            <label for="loginEmail" class="auth-label">Email or phone</label>
            <div class="auth-input-wrap">
              <span class="auth-input-icon">@</span>
              <input id="loginEmail" type="text" class="auth-input has-icon" placeholder="hello@example.com / 9876543210" required autocomplete="email" />
            </div>
            <small style="display:block;margin-top:4px;color:#b3885b;font-size:12px;">Use the email or mobile registered with Home Bites.</small>
          </div>

          <div class="auth-group">
            <label for="loginPassword" class="auth-label">Password</label>
            <div class="auth-input-wrap">
              <span class="auth-input-icon">*</span>
              <input id="loginPassword" type="password" class="auth-input has-icon" placeholder="Enter your password" required autocomplete="current-password" />
              <button type="button" class="auth-eye" data-target="loginPassword">SHOW</button>
            </div>
          </div>

          <div class="auth-row">
            <label class="remember-wrap" for="rememberMe">
              <input id="rememberMe" type="checkbox" />
              <span id="rememberMark" class="remember-mark"></span>
              <span>Remember me</span>
            </label>
            <a href="#" class="auth-link" onclick="event.preventDefault();">Forgot password?</a>
          </div>

          <button id="loginBtn" type="submit" class="auth-submit">Sign In</button>
          <p class="auth-switch">Don't have an account? <a class="auth-link" onclick="switchAuthView('signup')">Create one free</a></p>
        </form>

        <div id="loginMessage" class="auth-alert"></div>
      </section>

      <section id="authSignupView" class="auth-view">
        <form id="signupForm" novalidate>
          <div class="auth-group">
            <label for="signupPhone" class="auth-label">Phone number</label>
            <div class="auth-input-wrap">
              <input id="signupPhone" type="tel" class="auth-input" placeholder="10-digit mobile number" pattern="[0-9]{10}" required autocomplete="tel" />
            </div>
          </div>

          <div class="auth-group">
            <label for="signupName" class="auth-label">Full name</label>
            <div class="auth-input-wrap">
              <input id="signupName" type="text" class="auth-input" placeholder="Your name" required autocomplete="name" />
            </div>
          </div>

          <div class="auth-group">
            <label for="signupEmail" class="auth-label">Email address</label>
            <div class="auth-input-wrap">
              <input id="signupEmail" type="email" class="auth-input" placeholder="hello@example.com" required autocomplete="email" />
            </div>
          </div>

          <div class="auth-group">
            <label for="signupPassword" class="auth-label">Password</label>
            <div class="auth-input-wrap">
              <input id="signupPassword" type="password" class="auth-input" placeholder="Minimum 8 characters" minlength="8" required autocomplete="new-password" />
              <button type="button" class="auth-eye" data-target="signupPassword">SHOW</button>
            </div>
          </div>

          <div class="auth-group">
            <label for="signupAddress" class="auth-label">Address</label>
            <div class="auth-input-wrap">
              <input id="signupAddress" type="text" class="auth-input" placeholder="House no, street" required autocomplete="street-address" />
            </div>
          </div>

          <div class="auth-group">
            <label for="signupCity" class="auth-label">City</label>
            <div class="auth-input-wrap">
              <input id="signupCity" type="text" class="auth-input" placeholder="City" required autocomplete="address-level2" />
            </div>
          </div>

          <button id="signupBtn" type="submit" class="auth-submit">Create Account</button>
          <p class="auth-switch">Already have an account? <a class="auth-link" onclick="switchAuthView('login')">Login</a></p>
        </form>

        <div id="signupMessage" class="auth-alert"></div>
      </section>
    </section>
  </div>
</div>

<footer id="footer">
  <div class="footer-logo">homebites</div>
  <p class="footer-copy">¬© 2026 Home Bites. Phone: 9014763361 | Email: homebites@03112003.xyz</p>
  <div class="footer-links">
    <a href="#">Privacy</a>
    <a href="#">Terms</a>
    <a href="#">Contact</a>
    <a href="#">Help</a>
  </div>
</footer>

<script src="./config.js"></script>
<script src="./ui.js"></script>
<script>
  let token = localStorage.getItem('access_token');
  let user = JSON.parse(localStorage.getItem('user') || '{}');
  let allItems = [];
  const cart = {};
  let lastPlacedOrderId = null;

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text ?? '';
    return div.innerHTML;
  }

  function formatCurrency(amount) {
    return `Rs ${Number(amount || 0)}`;
  }

  function formatItemMeasure(value) {
    const text = String(value || '').trim();
    if (!text) return 'Standard';
    return /^\d+(\.\d+)?$/.test(text) ? `${text}g` : text;
  }

  function getItemPhotoSrc(item) {
    const file = String(item.photos || '').trim();
    if (!file) return './assets/logo.png';
    if (file.startsWith('http://') || file.startsWith('https://') || file.startsWith('./') || file.startsWith('/')) {
      return file;
    }
    return `./assets/items/${file}`;
  }

  function categorizeItem(item) {
    const text = `${item.item_name || ''} ${item.description || ''}`.toLowerCase();
    if (text.includes('sweet') || text.includes('laddu') || text.includes('halwa')) return 'Sweets';
    if (text.includes('snack') || text.includes('mixture') || text.includes('murukku')) return 'Snacks';
    if (text.includes('meal') || text.includes('rice') || text.includes('curry')) return 'Meals';
    return 'Specials';
  }

  function getOrdersStorageKey() {
    return `home_bites_orders_${user.user_id || 'guest'}`;
  }

  function getSavedOrders() {
    try {
      return JSON.parse(localStorage.getItem(getOrdersStorageKey()) || '[]');
    } catch (err) {
      return [];
    }
  }

  function saveOrderRecord(orderRecord) {
    const orders = getSavedOrders();
    orders.unshift(orderRecord);
    localStorage.setItem(getOrdersStorageKey(), JSON.stringify(orders.slice(0, 30)));
  }

  function getItemQuantity(itemId) {
    return cart[itemId]?.quantity || 0;
  }

  function addToCart(itemId) {
    const item = allItems.find(i => i.item_id === itemId);
    if (!item) return;
    lastPlacedOrderId = null;

    if (!cart[itemId]) {
      cart[itemId] = { item, quantity: 1 };
    } else {
      cart[itemId].quantity += 1;
    }

    renderSpecialPicks();
    renderCart();
  }

  function decrementFromCart(itemId) {
    if (!cart[itemId]) return;
    lastPlacedOrderId = null;
    cart[itemId].quantity -= 1;
    if (cart[itemId].quantity <= 0) delete cart[itemId];
    renderSpecialPicks();
    renderCart();
  }

  function renderSpecialPicks() {
    const wrap = document.getElementById('foodCards');
    const loading = document.getElementById('loadingItems');

    if (!allItems.length) {
      loading.style.display = 'block';
      loading.textContent = 'No items available right now.';
      wrap.innerHTML = '';
      return;
    }

    loading.style.display = 'none';

    wrap.innerHTML = allItems.map((item, index) => {
      const qty = getItemQuantity(item.item_id);
      const photo = getItemPhotoSrc(item);
      const reviewCount = 160 + (index * 37) % 300;

      return `
        <article class="fig-food-card">
          <div class="food-card-img">
            <img src="${escapeHtml(photo)}" alt="${escapeHtml(item.item_name)}" loading="lazy" onerror="this.onerror=null;this.replaceWith(Object.assign(document.createElement('span'),{className:'food-emoji',textContent:'üçΩÔ∏è'}));" />
          </div>
          <div class="food-card-name">${escapeHtml(item.item_name)}</div>
          <div class="rating-row"><span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span><span>(${reviewCount} reviews)</span></div>
          <div class="food-card-desc">${escapeHtml(item.description || 'Fresh homemade dish prepared with care.')} ‚Ä¢ ${escapeHtml(formatItemMeasure(item.weight))}</div>
          <div class="food-card-footer">
            <span class="food-price">${formatCurrency(item.price)}</span>
            ${qty === 0 ? `
              <button class="btn-add" type="button" onclick="addToCart(${item.item_id})">+</button>
            ` : `
              <div class="fig-stepper">
                <button type="button" onclick="decrementFromCart(${item.item_id})">-</button>
                <span>${qty}</span>
                <button type="button" onclick="addToCart(${item.item_id})">+</button>
              </div>
            `}
          </div>
        </article>
      `;
    }).join('');

    document.getElementById('menuCount').textContent = `${allItems.length}+`;
    document.getElementById('ordersToday').textContent = `${Math.max(1200, allItems.length * 32)}+`;
  }

  function renderCart() {
    const entries = Object.values(cart);
    const cartItemsEl = document.getElementById('cartItems');
    const cartEmptyEl = document.getElementById('cartEmpty');
    const cartErrorEl = document.getElementById('cartError');
    const successEl = document.getElementById('orderSuccess');

    const totalItems = entries.reduce((sum, entry) => sum + entry.quantity, 0);
    const subtotal = entries.reduce((sum, entry) => sum + (entry.item.price * entry.quantity), 0);

    document.getElementById('cartBadge').textContent = String(totalItems);
    document.getElementById('cartSubtotal').textContent = formatCurrency(subtotal);

    if (entries.length === 0) {
      cartEmptyEl.style.display = 'block';
      cartItemsEl.innerHTML = '';
      if (lastPlacedOrderId) {
        successEl.style.display = 'block';
        successEl.textContent = `Order #${lastPlacedOrderId} placed successfully.`;
      } else {
        successEl.style.display = 'none';
        successEl.textContent = '';
      }
      return;
    }

    cartEmptyEl.style.display = 'none';
    successEl.style.display = 'none';
    successEl.textContent = '';
    cartErrorEl.style.display = 'none';
    cartErrorEl.textContent = '';

    cartItemsEl.innerHTML = entries.map(({ item, quantity }) => `
      <div class="fig-cart-line">
        <div>
          <h4>${escapeHtml(item.item_name)}</h4>
          <p>${quantity} x ${formatCurrency(item.price)}</p>
        </div>
        <div class="fig-stepper">
          <button type="button" onclick="decrementFromCart(${item.item_id})">-</button>
          <span>${quantity}</span>
          <button type="button" onclick="addToCart(${item.item_id})">+</button>
        </div>
      </div>
    `).join('');
  }

  function openCartDrawer() {
    const drawer = document.getElementById('cartDrawer');
    drawer.classList.add('active');
    drawer.setAttribute('aria-hidden', 'false');
    document.body.style.overflow = 'hidden';
  }

  function closeCartDrawer() {
    const drawer = document.getElementById('cartDrawer');
    drawer.classList.remove('active');
    drawer.setAttribute('aria-hidden', 'true');
    if (!document.getElementById('authOverlay').classList.contains('active')) {
      document.body.style.overflow = 'auto';
    }
  }

  function applyAuthState() {
    token = getValidAccessToken();
    user = JSON.parse(localStorage.getItem('user') || '{}');
    if (!token) user = {};

    const loggedIn = Boolean(token && user && user.user_id);
    document.getElementById('signInBtn').style.display = loggedIn ? 'none' : '';
    document.getElementById('signUpBtn').style.display = loggedIn ? 'none' : '';
    document.getElementById('myOrdersBtn').style.display = loggedIn ? '' : 'none';
    updateProfileArea(loggedIn);
  }

  function getProfileInitial() {
    const primary = String(user.name || user.email || '').trim();
    if (!primary) return 'üë§';
    return primary[0].toUpperCase();
  }

  function updateProfileArea(loggedIn) {
    const wrapper = document.getElementById('profileArea');
    if (!wrapper) return;
    const dropdown = document.getElementById('profileDropdown');
    const nameEl = document.getElementById('profileName');
    const emailEl = document.getElementById('profileEmail');
    const phoneEl = document.getElementById('profilePhone');
    const initialEl = document.getElementById('profileInitial');

    if (loggedIn) {
      wrapper.style.display = '';
      if (nameEl) nameEl.textContent = user.name || 'User';
      if (emailEl) emailEl.textContent = user.email || 'Email not set';
      if (phoneEl) phoneEl.textContent = user.phone_number ? String(user.phone_number) : 'Phone not set';
      if (initialEl) initialEl.textContent = getProfileInitial();
    } else {
      wrapper.style.display = 'none';
      if (dropdown) dropdown.classList.remove('active');
      const profileBtn = document.getElementById('profileBtn');
      if (profileBtn) profileBtn.setAttribute('aria-expanded', 'false');
    }
  }

  async function hydrateProfileDetails() {
    if (!token) return;
    const missingProfileData = !user.phone_number || !user.address || !user.city;
    if (!missingProfileData) return;

    try {
      const res = await fetch(`${API_BASE_URL}/me`, {
        headers: { Authorization: `Bearer ${token}` }
      });

      if (!res.ok) return;
      const profile = await res.json();
      user = { ...user, ...profile };
      localStorage.setItem('user', JSON.stringify(user));
      applyAuthState();
    } catch (err) {
      console.warn('Could not refresh profile details:', err);
    }
  }

  async function loadItems() {
    try {
      const res = await fetch(`${API_BASE_URL}/items`);
      if (!res.ok) throw new Error('Failed to load items');
      const items = await res.json();
      allItems = Array.isArray(items) ? items : [];
      renderSpecialPicks();
    } catch (err) {
      document.getElementById('loadingItems').textContent = `Error: ${err.message}`;
    }
  }

  async function placeOrder() {
    const placeOrderBtn = document.getElementById('placeOrderBtn');
    const entries = Object.values(cart);
    const cartErrorEl = document.getElementById('cartError');

    if (entries.length === 0) {
      cartErrorEl.textContent = 'Add at least one item to place an order.';
      cartErrorEl.style.display = 'block';
      return;
    }

    if (!token || !user.user_id) {
      cartErrorEl.textContent = 'Please login to place an order.';
      cartErrorEl.style.display = 'block';
      closeCartDrawer();
      openAuthModal('login');
      return;
    }

    if (!user.address || !user.city) {
      cartErrorEl.textContent = 'Address/City missing in profile. Please login again.';
      cartErrorEl.style.display = 'block';
      return;
    }

    const today = new Date();
    const orderDate = today.toISOString().slice(0, 10);
    const deliveryDate = new Date(today.getTime() + 4 * 24 * 60 * 60 * 1000).toISOString().slice(0, 10);

    const payload = {
      user_id: user.user_id,
      order_status: 'pending',
      payment_status: 'pending',
      payment_mode: document.getElementById('paymentMode').value,
      order_date: orderDate,
      delivery_date: deliveryDate,
      address: String(user.address || '').trim(),
      city: String(user.city || '').trim(),
      items: entries.map(({ item, quantity }) => ({
        item_id: item.item_id,
        quantity,
        price: item.price
      }))
    };

    try {
      setButtonLoading(placeOrderBtn, 'Placing Order...', true);

      const res = await fetch(`${API_BASE_URL}/orders/complete`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${token}`
        },
        body: JSON.stringify(payload)
      });

      const data = await res.json();
      if (!res.ok) throw new Error(data.detail || 'Order failed');

      lastPlacedOrderId = data.order_id;
      saveOrderRecord({
        order_id: data.order_id,
        order_status: payload.order_status,
        payment_status: payload.payment_status,
        order_date: payload.order_date,
        delivery_date: payload.delivery_date,
        payment_mode: payload.payment_mode,
        address: payload.address,
        city: payload.city,
        items_count: payload.items.length,
        total_amount: data.total_amount,
        items: entries.map(({ item, quantity }) => ({
          item_id: item.item_id,
          item_name: item.item_name,
          quantity,
          unit_price: item.price,
          line_total: item.price * quantity,
          weight: item.weight || ''
        }))
      });

      Object.keys(cart).forEach(key => delete cart[key]);
      renderSpecialPicks();
      renderCart();
    } catch (err) {
      cartErrorEl.textContent = `Could not place order: ${err.message}`;
      cartErrorEl.style.display = 'block';
    } finally {
      setButtonLoading(placeOrderBtn, 'Place Order', false);
    }
  }

  function openAuthModal(view = 'login') {
    switchAuthView(view);
    const overlay = document.getElementById('authOverlay');
    overlay.classList.add('active');
    overlay.setAttribute('aria-hidden', 'false');
    document.body.style.overflow = 'hidden';
  }

  function closeAuthModal() {
    const overlay = document.getElementById('authOverlay');
    overlay.classList.remove('active');
    overlay.setAttribute('aria-hidden', 'true');
    if (!document.getElementById('cartDrawer').classList.contains('active')) {
      document.body.style.overflow = 'auto';
    }
    clearAlert(document.getElementById('loginMessage'));
    clearAlert(document.getElementById('signupMessage'));
  }

  function switchAuthView(view) {
    const showLogin = view === 'login';
    const loginTab = document.getElementById('authLoginTab');
    const signupTab = document.getElementById('authSignupTab');
    const loginView = document.getElementById('authLoginView');
    const signupView = document.getElementById('authSignupView');

    loginTab.classList.toggle('active', showLogin);
    signupTab.classList.toggle('active', !showLogin);
    loginView.classList.toggle('active', showLogin);
    signupView.classList.toggle('active', !showLogin);

    setTimeout(() => {
      const target = showLogin ? document.getElementById('loginEmail') : document.getElementById('signupPhone');
      if (document.getElementById('authOverlay').classList.contains('active')) target.focus();
    }, 20);
  }

  document.querySelectorAll('.auth-eye').forEach((btn) => {
    btn.addEventListener('click', () => {
      const input = document.getElementById(btn.dataset.target || '');
      if (!input) return;
      const hidden = input.type === 'password';
      input.type = hidden ? 'text' : 'password';
      btn.textContent = hidden ? 'HIDE' : 'SHOW';
    });
  });

  const rememberInput = document.getElementById('rememberMe');
  const rememberMark = document.getElementById('rememberMark');
  rememberInput.addEventListener('change', () => {
    if (rememberInput.checked) {
      rememberMark.style.background = '#ff6b35';
      rememberMark.style.borderColor = '#ff6b35';
      rememberMark.textContent = '‚úì';
    } else {
      rememberMark.style.background = '';
      rememberMark.style.borderColor = '';
      rememberMark.textContent = '';
    }
  });

  function logout() {
    stopSessionExpiryWatcher();
    token = null;
    user = {};
    localStorage.removeItem('access_token');
    localStorage.removeItem('user');
    applyAuthState();
  }

  function showMyOrders() {
    if (!token) {
      openAuthModal('login');
      return;
    }
    window.location.href = './my-orders.html';
  }

  document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') {
      closeCartDrawer();
      closeAuthModal();
    }
  });

  const profileBtn = document.getElementById('profileBtn');
  if (profileBtn) {
    profileBtn.addEventListener('click', (event) => {
      event.stopPropagation();
      const dropdown = document.getElementById('profileDropdown');
      if (!dropdown) return;
      const wasOpen = dropdown.classList.contains('active');
      dropdown.classList.toggle('active', !wasOpen);
      profileBtn.setAttribute('aria-expanded', String(!wasOpen));
    });
  }

  document.addEventListener('click', (event) => {
    const wrapper = document.getElementById('profileArea');
    const dropdown = document.getElementById('profileDropdown');
    if (!wrapper || !dropdown) return;
    if (!wrapper.contains(event.target)) {
      dropdown.classList.remove('active');
      document.getElementById('profileBtn')?.setAttribute('aria-expanded', 'false');
    }
  });

  document.getElementById('loginForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const message = document.getElementById('loginMessage');
    const loginBtn = document.getElementById('loginBtn');
    clearAlert(message);

      const identifier = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPassword').value;

    const body = new URLSearchParams();
      body.append('username', identifier);
    body.append('password', password);

    try {
      setButtonLoading(loginBtn, 'Signing in...', true);

      const res = await fetch(`${API_BASE_URL}/login`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: body.toString()
      });

      const data = await res.json();

      if (!res.ok) {
        throw new Error(data.detail || 'Login failed');
      }

      localStorage.setItem('access_token', data.access_token);
      localStorage.setItem('user', JSON.stringify(data.user));
      startSessionExpiryWatcher(() => {
        token = null;
        user = {};
        applyAuthState();
      });
      applyAuthState();
      setAlert(message, 'success', 'Login successful!');

      if (data.user && data.user.role === 'admin') {
        setTimeout(() => {
          window.location.href = './admin.html';
        }, 500);
        return;
      }

      setTimeout(() => {
        closeAuthModal();
      }, 450);
    } catch (err) {
      setAlert(message, 'error', err.message || 'Login failed');
    } finally {
      setButtonLoading(loginBtn, 'Sign In', false);
    }
  });

  document.getElementById('signupForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const message = document.getElementById('signupMessage');
    const signupBtn = document.getElementById('signupBtn');
    clearAlert(message);

    const payload = {
      name: document.getElementById('signupName').value.trim(),
      phone_number: Number(document.getElementById('signupPhone').value.trim()),
      email: document.getElementById('signupEmail').value.trim(),
      password: document.getElementById('signupPassword').value,
      role: 'user',
      address: document.getElementById('signupAddress').value.trim(),
      city: document.getElementById('signupCity').value.trim()
    };

    try {
      setButtonLoading(signupBtn, 'Creating...', true);

      const res = await fetch(`${API_BASE_URL}/register`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      const data = await res.json();

      if (!res.ok) {
        throw new Error(data.detail || 'Registration failed');
      }

      setAlert(message, 'success', `Account created successfully! User ID: ${data.user_id}. Please login.`);
      document.getElementById('signupForm').reset();

      setTimeout(() => {
        switchAuthView('login');
        clearAlert(message);
      }, 1300);
    } catch (err) {
      setAlert(message, 'error', err.message || 'Registration failed');
    } finally {
      setButtonLoading(signupBtn, 'Create Account', false);
    }
  });

  const reveals = document.querySelectorAll('.reveal');
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) entry.target.classList.add('visible');
    });
  }, { threshold: 0.12 });
  reveals.forEach((r) => observer.observe(r));

  async function init() {
    startSessionExpiryWatcher(() => {
      token = null;
      user = {};
      applyAuthState();
    });
    applyAuthState();
    await hydrateProfileDetails();
    renderCart();
    await loadItems();
  }

  init();
</script>
</body>
</html>
